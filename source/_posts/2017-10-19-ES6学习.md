---
title: ES6学习
date: 2017-10-19 15:28:36
tags: ES6
categories: 编程
---

## 关于执行顺序
`setTimeout`, `setInterval`, `setImmediate`, `process.nextTick`

目前根据我了解的是由于 `js` 是单线程，所以通过事件循环 `Event loop` 实现代码的异步执行。
其可理解为是在代码执行时，有一个任务队列，在执行完所有同步代码后，再按序执行队列的代码。

然后再分析执行顺序，定时器都是插入到队尾，`nextTick` 可理解为插入到队头(实际上是在队列执行前)，
其他的如 `Promise` 是在队列中排队

需要注意的是，下面两个的执行顺序是不定的
```javascript
setTimeout(function(){
    console.log('setTimeout');
}, 0);

setImmediate(function(){
    console.log('setImmediate');
})

// 我执行了10次，测的结果是6次 timeout 先于 immediate
```

据此就可以代码测试了


## Class
Class 内的 所有函数都相当于写在 prototype 对象中

但 static 关键字声明的是写在函数本身上
`static` 是定义在类上的方法或属性，称为静态方法(属性)，实例访问不到

get[](https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Functions/get)  
定义一个 getter

## Symbol
- Symbol 是值类型，所以不需要使用 new
- 类似字符串，所以会在某些情况产生矛盾，如下

```ecmascript 6
let obj = {};
let mySymbol = Symbol();
let mySymbol1 = Symbol('1');   // 传值只是为了调试打印出来时作区分

// 给 obj 添加属性 name 可以使用 . 运算符如下
obj.name = 'yzx';

// 而给 obj 添加属性 mySymbol
obj.mySymbol = 'mySymbol';

// 知识点！！！
// 但若使用 Symbol 类型的 mySymbol 则需要如下写法
obj[mySymbol] = 'mySymbol';
// 或者如下两种方式
obj = {
   [mySymbol]: function(){},
   [mySymbol1](arg){/*...*/}
};

Object.defineProperty(obj, mySymbol, {
    value: 'mySymbol'
});
```

#### Symbol.for
- 与 Symbol() 一样会返回一个 Symbol 类型的值
- 与直接调用 Symbol() 的区别是 Symbol.for() 会维护一个全局 symbol 注册表
```ecmascript 6
Symbol('s') === Symbol('s')  // false
Symbol.for('s') === Symbol.for('s')  // true

let a = Symbol('a');
let b = Symbol('a');
let c = Symbol.for('a');
let d = Symbol.for('a');

a === b // false

// 知识点！！！
a === c // false
c === d // true
```

#### Symbol.toStringTag
自定义的类如果定义了 Symbol.toStringTag 属性 ，注意是属性，不是方法，因为 get 关键字  
则 Object.prototype.toString.call() 会调用此属性的 getter 
```ecmascript 6
class ValidatorClass{
    get [Symbol.toStringTag](){
        return 'Validator';
    }
}

class Promise{
    get [Symbol.toStringTag](){
        return 'Promise';
    }
}
```

#### Symbol.species
知名的 Symbol.species 是个函数值属性，其被构造函数用以创建派生对象--- MDN

简单的讲子类使用继承的方法时，返回的是基类的实例，而不是子类的实例。
```ecmascript 6
class Array1 extends Array {
  static get [Symbol.species]() { return Array; }
}

const a = new Array1(1, 2, 3);
const mapped = a.map(x => x * x);

console.log(mapped instanceof Array1);
// expected output: false

console.log(mapped instanceof Array);
// expected output: true
```


一般常用写法 
```ecmascript 6
Object.defineProperty(Promise, Symbol.species, {
	get: function () { return this }
})
```


## reduce 实现




